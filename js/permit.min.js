/*
* Permit.js
* @version      0.3
* @copyright    Tarek Anandan (http://www.technotarek.com)
*/
(function(e,t,n,r){e.permit=function(n){function s(e){if(e){t.location.href=e}else{t.location.reload()}}function o(t){t=typeof t!=="undefined"?t:i.permits;var n=0;e.each(e(i.permits),function(t,s){if(e.cookie(r+i.permits[t])){n++}});return n}function u(t){var n='<select id="permit-options" class="form-control input-sm">';e.each(e(t),function(e,t){n+='<option value="'+t+'">'+t+"</option>"});n+="</select>";e("#permit-agent").html(n)}function a(t){e.each(e(t),function(t,n){e.removeCookie(r+n)})}var r="permit_";var i=e.extend({},e.permit.defaults,n);e(".permit-all, .permit-force").hide();e.each(e(i.permits),function(t,n){e(".permit-"+n).hide()});e.each(e(i.permits),function(t,n){if(e.cookie(r+i.permits[t])){for(var s=0;s<i.permits.length;s++){if(s!=t){e(".permit-"+n).hide()}}e(".permit-"+n).show()}var o=e(".permit-issue-"+n).data("permit-trigger")?e(".permit-issue-"+n).data("permit-trigger"):"click";e(".permit-issue-"+n).on(o,function(){var t=e(this).data("permit-destination");a(i.permits);e.permit.issuePermit(n,t)});var o=e(".permit-revoke-"+n).data("permit-trigger")?e(".permit-revoke-"+n).data("permit-trigger"):"click";e(".permit-revoke-"+n).on(o,function(){var t=e(this).data("permit-destination");var r=e(this).data("permit-new");e.permit.revokePermit(n,r,t)})});if(o()<1){e(".permit-none").show();e(".permit-force").each(function(){var t=e(this).data("permit-message");e(this).html(t).show()})}else{e(".permit-none").hide();e(".permit-all").show()}u(i.permits);e.permit.issuePermit=function(t,n){e.cookie(r+t,1);s(n)};e.permit.revokePermit=function(t,n,i){e.removeCookie(r+t);if(n){e.permit.issuePermit(n)}s(i)};e(".permit-reissue").on("click",function(){a(i.permits);var t=e("#permit-options").val();e.permit.issuePermit(t)});e(".permit-revoke-all").on("click",function(){var t=e(this).data("permit-destination");a(i.permits);s(t)})};e.permit.defaults={permits:["admin"],reissueDestination:"reload"}})(jQuery,window,document)
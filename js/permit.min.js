/*
* Permit.js
* @version      0.2
* @copyright    Tarek Anandan (http://www.technotarek.com)
*/
(function(e){var t;e.permit=function(n){t=jQuery.extend({permits:["admin"],reissueDestination:"reload"},n);e(document).ready(function(){function r(e){if(e){window.location.href=e}else{window.location.reload()}}function i(t,i){e.cookie(n+t,1);r(i)}function s(t,s,o){e.removeCookie(n+t);if(s){i(s)}r(o)}function o(t){e.each(e(t),function(t,r){e.removeCookie(n+r)})}function u(r){r=typeof r!=="undefined"?r:t.permits;var i=0;e.each(e(t.permits),function(r,s){if(e.cookie(n+t.permits[r])){i++}});return i}function a(t){var n='<select id="permit-options" class="form-control input-sm">';e.each(e(t),function(e,t){n+='<option value="'+t+'">'+t+"</option>"});n+="</select>";e("#permit-agent").html(n)}e(".permit-all, .permit-force").hide();e.each(e(t.permits),function(t,n){e(".permit-"+n).hide()});var n="permit_";e.each(e(t.permits),function(r,u){if(e.cookie(n+t.permits[r])){for(var a=0;a<t.permits.length;a++){if(a!=r){e(".permit-"+u).hide()}}e(".permit-"+u).show()}var f=e(".permit-issue-"+u).data("permit-trigger")?e(".permit-issue-"+u).data("permit-trigger"):"click";e(".permit-issue-"+u).on(f,function(){var n=e(this).data("permit-destination");o(t.permits);i(u,n)});var f=e(".permit-revoke-"+u).data("permit-trigger")?e(".permit-revoke-"+u).data("permit-trigger"):"click";e(".permit-revoke-"+u).on(f,function(){var t=e(this).data("permit-destination");var n=e(this).data("permit-new");s(u,n,t)})});if(u()<1){e(".permit-none").show();e(".permit-force").each(function(){var t=e(this).data("permit-message");e(this).html(t).show()})}else{e(".permit-none").hide();e(".permit-all").show()}a(t.permits);e(".permit-reissue").on("click",function(){o(t.permits);var n=e("#permit-options").val();i(n)});e(".permit-revoke-all").on("click",function(){var n=e(this).data("permit-destination");o(t.permits);r(n)})})}})(jQuery)